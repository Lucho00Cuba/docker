<?xml version="1.0" encoding="UTF-8"?>
<sc:ServiceDefinition xmlns:sc="http://www.platform.com/ego/2005/05/schema/sc" xmlns:ego="http://www.platform.com/ego/2005/05/schema"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  xsi:schemaLocation="http://www.platform.com/ego/2005/05/schema/sc ../sc.xsd http://www.platform.com/ego/2005/05/schema ../ego.xsd" ServiceName="RSA">
  <sc:Version>1.2</sc:Version>
  <sc:Description>EGO: Gridsync Server</sc:Description>
  <sc:MinInstances>1</sc:MinInstances>
  <sc:MaxInstances>10000</sc:MaxInstances>
  <sc:Priority>10</sc:Priority>
  <sc:MaxInstancesPerSlot>1</sc:MaxInstancesPerSlot>
  <sc:MaxInstancesPerHost>1</sc:MaxInstancesPerHost>
  <sc:NeedCredential>TRUE</sc:NeedCredential>
  <sc:ControlPolicy>
    <sc:StartType>MANUAL</sc:StartType>
    <sc:MaxRestarts>10</sc:MaxRestarts>
    <sc:HostFailoverInterval>PT1S</sc:HostFailoverInterval>
  </sc:ControlPolicy>
  <sc:AllocationSpecification>
    <ego:ConsumerID>/ClusterServices/EGOClusterServices</ego:ConsumerID>
<!--The ResourceType specifies a "compute element" identified by the URI used below-->
    <sc:ResourceSpecification ResourceType="http://www.platform.com/ego/2005/05/schema/ce">
      <ego:ResourceGroupName>InternalResourceGroup</ego:ResourceGroupName>
      <!--ego:ResourceRequirement>select(!'LINUXPPC64' &amp;&amp; !'X86_64')</ego:ResourceRequirement-->
    </sc:ResourceSpecification>
  </sc:AllocationSpecification>
  <sc:ActivityDescription>
    <ego:Attribute name="hostType" type="xsd:string">all</ego:Attribute>
    <ego:ActivitySpecification>
      <ego:Command>${EGO_TOP}/4.0/${EGO_MACHINE_TYPE}/etc/rsa</ego:Command>
      <ego:ExecutionUser>egoadmin</ego:ExecutionUser>
      <ego:EnvironmentVariable name="EGO_TOP">${EGO_TOP}</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="SOAM_HOME">${EGO_TOP}/soam</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="PATH">${EGO_TOP}/4.0/${EGO_MACHINE_TYPE}/bin</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="LD_LIBRARY_PATH">${EGO_TOP}/4.0/${EGO_MACHINE_TYPE}/lib:/usr/ucblib/amd64</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_ENABLE_GRIDSYNC">N</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_SERVER_THREADS">2</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_AGENT_PORT">17881</ego:EnvironmentVariable>  
      <ego:EnvironmentVariable name="GS_AGENT_PORT_RANGE"></ego:EnvironmentVariable> 
      <ego:EnvironmentVariable name="GS_TRANSFER_CHUNK_SIZE_KB">10240</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_STORAGE_DIR">${EGO_TOP}/eservice/rs/.cache_local</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_CLUSTER_ADMIN">egoadmin</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_CONSISTENCY_INTERVAL_MINUTES">720</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_BANDWIDTH_MAX_MBPS">0</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_DATASET_CHUNK_TIMEOUT_SECONDS">30</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_PEER_RESPONSE_TIMEOUT_SECONDS">30</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_AGENT_HEARTBEAT_INTERVAL_SECONDS">300</ego:EnvironmentVariable>
      <ego:WorkingDirectory>${EGO_TOP}/eservice/rs/work</ego:WorkingDirectory>
      <ego:Umask>0022</ego:Umask>
      <ego:Rlimit type="soft" name="NOFILE">6400</ego:Rlimit>
    </ego:ActivitySpecification>
  </sc:ActivityDescription>
  <sc:ActivityDescription>
    <ego:Attribute name="hostType" type="xsd:string">NTX86</ego:Attribute>
    <ego:ActivitySpecification>
      <ego:Command>"${EGO_TOP}/4.0/etc/rsa"</ego:Command>
      <ego:EnvironmentVariable name="EGO_TOP">${EGO_TOP}</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="SOAM_HOME">${EGO_TOP}/soam</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="PATH">${EGO_TOP}/4.0/lib;${EGO_TOP}/4.0/bin</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_ENABLE_GRIDSYNC">N</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_SERVER_THREADS">2</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_AGENT_PORT">17881</ego:EnvironmentVariable>  
      <ego:EnvironmentVariable name="GS_AGENT_PORT_RANGE"></ego:EnvironmentVariable> 
      <ego:EnvironmentVariable name="GS_TRANSFER_CHUNK_SIZE_KB">10240</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_STORAGE_DIR">${EGO_TOP}/eservice/rs/.cache_local</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_CONSISTENCY_INTERVAL_MINUTES">720</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_BANDWIDTH_MAX_MBPS">0</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_DATASET_CHUNK_TIMEOUT_SECONDS">30</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_PEER_RESPONSE_TIMEOUT_SECONDS">30</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_AGENT_HEARTBEAT_INTERVAL_SECONDS">300</ego:EnvironmentVariable>
      <ego:WorkingDirectory>${EGO_TOP}/eservice/rs/work</ego:WorkingDirectory>
      <ego:Umask>0022</ego:Umask>
      <ego:Rlimit type="soft" name="NOFILE">6400</ego:Rlimit>
    </ego:ActivitySpecification>
  </sc:ActivityDescription>
  <sc:ActivityDescription>
    <ego:Attribute name="hostType" type="xsd:string">NTX64</ego:Attribute>
    <ego:ActivitySpecification>
      <ego:Command>"${EGO_TOP}/4.0/etc/rsa"</ego:Command>
      <ego:EnvironmentVariable name="EGO_TOP">${EGO_TOP}</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="SOAM_HOME">${EGO_TOP}/soam</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="PATH">${EGO_TOP}/4.0/lib;${EGO_TOP}/4.0/bin</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_ENABLE_GRIDSYNC">N</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_SERVER_THREADS">2</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_AGENT_PORT">17881</ego:EnvironmentVariable>  
      <ego:EnvironmentVariable name="GS_AGENT_PORT_RANGE"></ego:EnvironmentVariable> 
      <ego:EnvironmentVariable name="GS_TRANSFER_CHUNK_SIZE_KB">10240</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_STORAGE_DIR">${EGO_TOP}/eservice/rs/.cache_local</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_CONSISTENCY_INTERVAL_MINUTES">720</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_BANDWIDTH_MAX_MBPS">0</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_DATASET_CHUNK_TIMEOUT_SECONDS">30</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_PEER_RESPONSE_TIMEOUT_SECONDS">30</ego:EnvironmentVariable>
      <ego:EnvironmentVariable name="GS_AGENT_HEARTBEAT_INTERVAL_SECONDS">300</ego:EnvironmentVariable>
      <ego:WorkingDirectory>${EGO_TOP}/eservice/rs/work</ego:WorkingDirectory>
      <ego:Umask>0022</ego:Umask>
      <ego:Rlimit type="soft" name="NOFILE">6400</ego:Rlimit>
    </ego:ActivitySpecification>
  </sc:ActivityDescription>
</sc:ServiceDefinition>
